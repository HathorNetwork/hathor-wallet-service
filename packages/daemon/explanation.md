When a `VERTEX_METADATA_CHANGED` event arrives, the machine invokes `metadataDiff` to compare the event's metadata against the database. It detects all changes and returns them as an array of types. Mutually exclusive changes (TX_NEW, TX_VOIDED, TX_UNVOIDED) return immediately as a single-element array. Independent changes (NC_EXEC_VOIDED, TX_FIRST_BLOCK) are collected together â€” a single event can carry both. A `dispatching` state then processes the queue one by one: it matches the first element to the corresponding handler, executes it, and loops back to dispatch the next. When the queue is empty, it falls through to `handlingUnhandledEvent`, which updates the last synced event and sends the ACK.
